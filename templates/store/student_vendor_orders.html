{% extends "base.html" %}
{% block title %}My Orders{% endblock %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-4 fw-bold text-gradient">Orders for My Items</h2>

  <!-- Printing Orders -->
  <h3>üñ®Ô∏è Printing Orders</h3>
  {% if print_orders %}
  <table class="table table-hover mb-5">
    <thead>
      <tr>
        <th>ID</th>
        <th>Student</th>
        <th>Document</th>
        <th>Status</th>
        <th>Placed</th>
        <th>Update</th>
      </tr>
    </thead>
    <tbody>
      {% for order in print_orders %}
      <tr>
        <td>#{{ order.id }}</td>
        <td>{{ order.student.username }}</td>
        <td><a href="{{ order.document.url }}" target="_blank">Download</a></td>
        <td>
          <span class="badge 
            {% if order.status == 'pending' %}bg-secondary
            {% elif order.status == 'in_progress' %}bg-warning text-dark
            {% elif order.status == 'done' %}bg-success
            {% else %}bg-danger{% endif %}">
            {{ order.get_status_display }}
          </span>
        </td>
        <td>{{ order.created_at|date:"M d, Y H:i" }}</td>
        <td>
          <form method="post" action="{% url 'update_order_status' 'print' order.id %}">
            {% csrf_token %}
            <select name="status" class="form-select form-select-sm d-inline" style="width:auto; display:inline-block;">
              {% for key, val in order.STATUS_CHOICES %}
                <option value="{{ key }}" {% if order.status == key %}selected{% endif %}>{{ val }}</option>
              {% endfor %}
            </select>
            <button type="submit" class="btn btn-sm btn-outline-primary">Update</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p class="text-muted">No printing orders yet.</p>
  {% endif %}

  <!-- Shop Orders -->
  <h3>üõí Shop Orders</h3>
  {% if shop_orders %}
  <table class="table table-hover">
    <thead>
      <tr>
        <th>ID</th>
        <th>Buyer</th>
        <th>Item</th>
        <th>Qty</th>
        <th>Status</th>
        <th>Placed</th>
        <th>Update</th>
      </tr>
    </thead>
    <tbody>
      {% for order in shop_orders %}
      <tr>
        <td>#{{ order.id }}</td>
        <td>{{ order.buyer.username }}</td>
        <td>{{ order.item.name }}</td>
        <td>{{ order.quantity }}</td>
        <td>
          <span class="badge 
            {% if order.status == 'pending' %}bg-secondary
            {% elif order.status == 'in_progress' %}bg-warning text-dark
            {% elif order.status == 'delivered' %}bg-info
            {% elif order.status == 'done' %}bg-success
            {% else %}bg-danger{% endif %}">
            {{ order.get_status_display }}
          </span>
        </td>
        <td>{{ order.created_at|date:"M d, Y H:i" }}</td>
        <td>
          <form method="post" action="{% url 'update_student_order_status' 'shop' order.id %}">
            {% csrf_token %}
            <select name="status" class="form-select form-select-sm d-inline" style="width:auto; display:inline-block;">
              {% for key, val in order.STATUS_CHOICES %}
                <option value="{{ key }}" {% if order.status == key %}selected{% endif %}>{{ val }}</option>
              {% endfor %}
            </select>
            <button type="submit" class="btn btn-sm btn-outline-primary">Update</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p class="text-muted">No shop orders yet.</p>
  {% endif %}
</div>

<style>
  .text-gradient {
    background: linear-gradient(90deg, #57bca6, #1b5644, #ff5722);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  h2, h3 {
    font-weight: 700;
    color: #0d6efd; /* primary blue for titles */
  }

  .table {
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }

  .table thead {
    background: linear-gradient(135deg, #20c997, #0d6efd); /* teal ‚Üí blue */
    color: #fff;
  }

  .table-hover tbody tr:hover {
    background: rgba(13,110,253,0.08);
    transition: 0.25s ease-in-out;
  }

  .badge {
    font-size: 0.85rem;
    padding: 0.5em 0.75em;
    border-radius: 8px;
  }

  .form-select-sm {
    border-radius: 8px;
  }

  .btn-outline-primary {
    border-radius: 10px;
    background: linear-gradient(135deg, #28a745, #016b4c, #207100);
    border: none;
    color: white;
    transition: all 0.3s ease-in-out;
  }
  .btn-outline-primary:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  }

  .text-muted {
    font-style: italic;
    color: #6c757d !important;
  }
</style>

{% endblock %}
